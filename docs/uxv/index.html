<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.6.3"><meta name=author content="Lubin Kerhuel"><meta name=description content="The UxV toolbox provides matlab script and Simulink blocks for autopilot. Script to decode, visualise MAVlink logs and configure a Simulink model feeding MAVlink signal for simulation. Block adds MAVLink, GPS, and FrSky protocol S.BUS, Smart Port and F.Port feature to a rapid prototyping model used for code generation working with the MPLAB blocks from microchip (targeting dsPIC microcontrollers)."><link rel=alternate hreflang=en-us href=https://lubin.kerhuel.eu/uxv/><meta name=theme-color content="hsl(195, 90%, 58%)"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Istok+Web%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-THRKWJJ');</script><link rel=alternate href=/uxv/index.xml type=application/rss+xml title="Rapid Control Prototyping"><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/img/icon-32.png><link rel=apple-touch-icon type=image/png href=/img/icon-192.png><link rel=canonical href=https://lubin.kerhuel.eu/uxv/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@LubinKerhuel"><meta property="twitter:creator" content="@LubinKerhuel"><meta property="og:site_name" content="Rapid Control Prototyping"><meta property="og:url" content="https://lubin.kerhuel.eu/uxv/"><meta property="og:title" content="UxV toolbox | Rapid Control Prototyping"><meta property="og:description" content="The UxV toolbox provides matlab script and Simulink blocks for autopilot. Script to decode, visualise MAVlink logs and configure a Simulink model feeding MAVlink signal for simulation. Block adds MAVLink, GPS, and FrSky protocol S.BUS, Smart Port and F.Port feature to a rapid prototyping model used for code generation working with the MPLAB blocks from microchip (targeting dsPIC microcontrollers)."><meta property="og:image" content="https://lubin.kerhuel.eu/img/img/firstar1600-qx7.jpg"><meta property="twitter:image" content="https://lubin.kerhuel.eu/img/img/firstar1600-qx7.jpg"><meta property="og:locale" content="en-us"><meta property="og:updated_time" content="2019-07-01T00:00:00+00:00"><title>UxV toolbox | Rapid Control Prototyping</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=dark><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Rapid Control Prototyping</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Rapid Control Prototyping</a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#projects><i class="fas fa-car-battery pr-1" style=color:#34c4f4></i><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#posts><i class="fas fa-book pr-1" style=color:#34c4f4></i><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><i class="fas fa-question pr-1" style=color:#34c4f4></i><span>About</span></a></li><li class=nav-item><a class=nav-link href=/uxv/><i class="fas fa-paper-plane pr-1" style=color:#34c4f4></i><span>UxV blockset</span></a></li><li class=nav-item><a class=nav-link href=https://fr.mathworks.com/matlabcentral/fileexchange/71892 target=_blank rel=noopener><i class="fas fa-microchip pr-1" style=color:#34c4f4></i><span>MPLAB blockset</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class="docs-toc-item active"><a class=docs-toc-link href=/uxv/>UxV toolbox</a></div><div class=docs-toc-item><a class=docs-toc-link href=/uxv/block-receiver-telemetry/>blocks</a><ul class="nav docs-sidenav"><li><a href=/uxv/block-receiver-telemetry/>receiver-telemetry</a></li><li><a href=/uxv/block-sensor/>sensor</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#matlab-scripts-for-mavlink>Matlab scripts for MAVLink</a></li><li><a href=#simulink-blocks>Simulink blocks</a></li><li><a href=#installation>Installation</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>UxV toolbox</h1><div class=article-style><h2 id=overview>Overview</h2><p>The UxV toolbox for Matlab/Simulink provides Matlab scripts and simulink blocks for UAVs to handle MAVLink protocol, GPS, RC receivers and telemetry protocols.</p><ul><li>Matlab script for post flight data analyses (MAVLink).</li><li>Simulink blocks for autopilote model based design (Rapid Control Prototyping using Simulink)</li></ul><p>This model-based design and analysis tools speed-up the back and forth between experimental tests and simulation.</p><h2 id=matlab-scripts-for-mavlink>Matlab scripts for MAVLink</h2><p>Three main scripts enable decoding MAVLink messages, creating simulink model for simulation based on logged data, and generating map trajectory trace from GPS messages.</p><table><thead><tr><th>Script</th><th>Input</th><th>Output</th><th>Function</th></tr></thead><tbody><tr><td>(1) <em>mavlink2mat</em></td><td>Mavlink log</td><td>.mat</td><td>matlab analysis</td></tr><tr><td>(2) <em>mavlink2simulink</em></td><td>Mavlink log</td><td>.mat / .mdl (.slx)</td><td>simulation based on real data</td></tr><tr><td>(3) <em>mavlink2kml</em></td><td>Mavlink log</td><td>.kml</td><td>plot GPS trace(s) on a map</td></tr><tr><td><em>mavlink2gui</em></td><td>Mavlink log</td><td>GUI</td><td>graphical exploration of mavlink log</td></tr></tbody></table><p><em>mavlinkgui</em> script opens a Graphical User Interface to explore MAVLink data. It list MAVLink messages found in a log file and plot selected {message - value}. Plot script is customizable enabling user to go beyond a simple plot. The GUI provides access to the three scripts mentioned above.</p><h2 id=simulink-blocks>Simulink blocks</h2><p>10 added blocks add essentials UAV features to implement an autopilot on a dsPIC DSC. Theses blocks complete the MPLAB blocks for Simulink from Microchip providing peripheral blocks for code generation. Theses works on top of the MathWorks Embedded Coder. Added features:</p><ul><li>GPS<ul><li><em>GPS Parser</em> to decode NMEA messages</li></ul></li><li>MATH<ul><li><em>Quaternion to Cardan FxPt</em> to convert quaternion angle to Cardan angle in fixed point (similar to euler)</li></ul></li><li>MAVLink:<ul><li><em>SEND</em> (send a message)</li><li><em>RECEIVE</em> (Receive a message)</li><li><em>MAVLink Data</em> (Way Points data)</li><li><em>MAVLink Parser</em> (decode input message and implement WayPoint<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> and Parameter<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> protocols)</li></ul></li><li><a href=block-receiver-telemetry>Receivers-Telemetry</a><ul><li><em>S.BUS</em> receive RC channels</li><li><em>Smart Port</em> send telemetry values</li><li><em>F.Port</em> receive RC channels + send telemetry</li><li><em>Sensor for Smart.Port or F.Port</em> set values to send over telemetry<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></li></ul></li></ul><p>Except the MATH block, theses blocks are typically connected to the dsPIC UART Rx/Tx block to send/receive the data flow from a GPS, a receiver, a radio link.</p><h2 id=installation>Installation</h2><p>Theses blocks are developped by Lubin Kerhuel and distributed for free with the <a href=https://www.mathworks.com/matlabcentral/fileexchange/71892-mplab-device-blocks-for-simulink>MPLAB device blocks for Simulink</a> from Microchip.</p><ol><li>Install the MPLAB Device Blocks for Microchip</li><li>type <em>pinInfo</em>, click on <em>go to Third Part Tools folder</em></li><li>Start script <em>UxV_Blockset_Installer.p</em> in the UxV_blockset folder.</li></ol><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><em>Way Point protocol</em> allows setting and reading WayPoint from a MAVLink compatible ground station. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><em>Parameter protocol</em> enable tuning from any MAVLink ground station the Simulink tunable parameters which are normally tuned with External Mode or from the Processor In the Loop simulation (PIL). <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><em>Sensor for Smart.Port or F.Port</em> block is used with either the <em>Smart Port</em> of the <em>F.Port</em> block. Theses protocol allows sending telemetry packet back to the Remote Controller (RC) interface. It enables emulation of Frsky sensor (battery voltage and current, variometer, airspeed, GPS) adding features to your remote easily. They also enable emulation of BetaFlight telemetry. Used with LUA script, this add features like artificial horizon, air speed, vertical speed, distance from home and many other to your remote (tested with <a href=https://github.com/yaapu/FrskyTelemetryScript/wiki>yapuu LUA scripts</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=article-tags><a class="badge badge-light" href=/tags/rapid-prototyping/>rapid prototyping</a>
<a class="badge badge-light" href=/tags/model-based-design-mbd/>model-based design (MBD)</a>
<a class="badge badge-light" href=/tags/matlab/>matlab</a>
<a class="badge badge-light" href=/tags/simulink/>simulink</a>
<a class="badge badge-light" href=/tags/uav/>UAV</a>
<a class="badge badge-light" href=/tags/uxv/>UxV</a>
<a class="badge badge-light" href=/tags/mavlink/>MAVLink</a>
<a class="badge badge-light" href>GPS</a>
<a class="badge badge-light" href>FrSky</a>
<a class="badge badge-light" href=/tags/s.bus/>S.BUS</a>
<a class="badge badge-light" href=/tags/smart-port/>Smart Port</a>
<a class="badge badge-light" href=/tags/f.port/>F.Port</a></div><div class=article-widget><div class=post-nav></div></div></div><div class=body-footer><p>Last updated on November 2019</p></div></article><footer class=site-footer><p class=powered-by>© 2019 Lubin Kerhuel &#183;
Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script>const code_highlighting=false;</script><script>const search_config={"indexURI":"/index.json","minLength":1,"threshold":0.3};const i18n={"no_results":"No results found","placeholder":"Search...","results":"results found"};const content_type={'post':"Posts",'project':"Projects",'publication':"Publications",'talk':"Talks"};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add();</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.8297258b1a9da0e488ea2d19b4a31ace.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>