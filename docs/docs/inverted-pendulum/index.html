<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 3.3.0"><meta name=generator content="Hugo 0.53"><meta name=author content="Lubin Kerhuel"><meta name=description content="Top of the inverted pendulum
Presentation Stabilisation of an inverted pendulum is a common engineering challenge. Objective is to build an accessible pendulum platform (DIY1]) for experiment various feedback control loop. The hardware is described, the simulation model of the pendulum is presented and an LQR2 feedback control loop is tested."><link rel=alternate hreflang=en-us href=https://lubin.kerhuel.eu/docs/inverted-pendulum/><meta name=theme-color content="hsl(195, 90%, 58%)"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.0/css/all.css integrity=sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css crossorigin=anonymous><link rel=stylesheet href="//fonts.googleapis.com/css?family=Istok+Web|Roboto:400,400italic,700|Roboto+Mono"><link rel=stylesheet href=/styles.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-90899-5','auto');ga('require','eventTracker');ga('require','outboundLinkTracker');ga('require','urlChangeTracker');ga('send','pageview');</script><script async src=//www.google-analytics.com/analytics.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin=anonymous></script><link rel=alternate href=https://lubin.kerhuel.eu/index.xml type=application/rss+xml title="Rapid Control Prototyping"><link rel=feed href=https://lubin.kerhuel.eu/index.xml type=application/rss+xml title="Rapid Control Prototyping"><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png href=/img/icon.png><link rel=apple-touch-icon type=image/png href=/img/icon-192.png><link rel=canonical href=https://lubin.kerhuel.eu/docs/inverted-pendulum/><meta property=twitter:card content=summary><meta property=twitter:site content=@LubinKerhuel><meta property=twitter:creator content=@LubinKerhuel><meta property=og:site_name content="Rapid Control Prototyping"><meta property=og:url content=https://lubin.kerhuel.eu/docs/inverted-pendulum/><meta property=og:title content="Inverted Pendulum | Rapid Control Prototyping"><meta property=og:description content="Top of the inverted pendulum
Presentation Stabilisation of an inverted pendulum is a common engineering challenge. Objective is to build an accessible pendulum platform (DIY1]) for experiment various feedback control loop. The hardware is described, the simulation model of the pendulum is presented and an LQR2 feedback control loop is tested."><meta property=og:image content=https://lubin.kerhuel.eu/img/icon-192.png><meta property=og:locale content=en-us><meta property=article:modified_time content=2019-01-31T17:23:28&#43;01:00><title>Inverted Pendulum | Rapid Control Prototyping</title></head><body id=top data-spy=scroll data-target=#TableOfContents data-offset=71 class=dark><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off role=textbox spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id=navbar-main><div class=container><a class=navbar-brand href=/>Rapid Control Prototyping</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#projects><span>Home</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Projects</span>
<span class=caret></span></a><ul class=dropdown-menu><li class="dropdown-item my-0 py-0 mx-0 px-0"><a href=/docs/inverted-pendulum/><span>Inverted Pendulum</span></a></li><li class="dropdown-item my-0 py-0 mx-0 px-0"><a href=/project/lab-dc-motor/><span>DC Motor</span></a></li></ul></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control id=search-query placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/docs/>Overview</a></div><div class="docs-toc-item active"><a class=docs-toc-link href=/docs/inverted-pendulum/>Inverted Pendulum</a></div><div class=docs-toc-item><a class=docs-toc-link href=/project/lab-dc-motor/>DC Motor</a></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><p class=docs-toc-title>On this page</p><nav id=TableOfContents><ul><li><a href=#presentation>Presentation</a></li><li><a href=#hardware>Hardware</a><ul><li><a href=#overview>Overview</a></li><li><a href=#head-electronics>Head electronics</a><ul><li><a href=#microcontroller>Microcontroller</a></li><li><a href=#imu-sensor>IMU sensor</a></li><li><a href=#UARTINTERFACE>UART interface</a></li></ul></li><li><a href=#hw_trolley>Base trolley</a><ul><li><a href=#motors>Motors</a></li><li><a href=#power-electronics>Power electronics</a></li><li><a href=#batteries>Batteries</a></li></ul></li></ul></li><li><a href=#pendulum-model>Pendulum Model</a><ul><li><a href=#equations>Equations</a></li><li><a href=#identification>Identification</a></li></ul></li><li><a href=#trolley-model>Trolley Model</a><ul><li><a href=#equations-1>Equations</a></li><li><a href=#identification-1>Identification</a></li></ul></li><li><a href=#controller>Controller</a></li></ul></nav><ul class="nav toc-top"><li><a href=#>Back to top</a></li></ul><div class=connect-widget><ul class="connect-links fa-ul"><li><i class="fa-li fas fa-edit"></i><a href=http://prose.io/#lubinkerhuel/hugo/edit/master/content/docs%2finverted-pendulum.md>Edit this page</a></li></ul></div></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article itemscope itemtype=http://schema.org/Article><div class=docs-article-container><h1 itemprop=name>Inverted Pendulum</h1><div class=article-style itemprop=articleBody><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=/js/load-photoswipe.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><link rel=stylesheet href=/css/hugo-easy-gallery.css><div class=box style=max-width:45%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pendulum_platform_top.png alt="Top of the inverted pendulum"></div><a href=/img/pendulum_platform_top.png itemprop=contentUrl></a><figcaption><p>Top of the inverted pendulum</p></figcaption></figure></div><h1 id=presentation>Presentation</h1><p>Stabilisation of an inverted pendulum is a common engineering challenge. Objective is to build an accessible pendulum platform (DIY<sup class=footnote-ref id=fnref:DIY><a href=#fn:DIY>1</a></sup>]) for experiment various feedback control loop.
The hardware is described, the simulation model of the pendulum is presented and an LQR<sup class=footnote-ref id=fnref:LQR><a href=#fn:LQR>2</a></sup> feedback control loop is tested.</p><p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=//player.vimeo.com/video/309876246 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>Video of the stabilized platform with a 4 state LQR feedback loop. The platform is completely autonomous (no user input).</p><p>The electronic placed at the top of the pendulum composed of a dsPIC 16 bits microcontroller and an inertial sensor (accelerometers and rate gyro). The base of the pendulum is a modified RC toys comprising two wheels driven by two independent DC motor (see <a href=#hw_trolley>pictures below</a>).</p><h1 id=hardware>Hardware</h1><h2 id=overview>Overview</h2><p>The head and the base trolley are described successively. They are separated with an $8mm$ carbon tube. The pendulum length is $0.52m$ from wheel axis to the top. Wheels diameters is $8cm$. Pendulum total weight is $200g$ comprising $111g$ for the 4 AA batteries.</p><div class=box style=max-width:60%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pendulum_platform_reduced_horizontal.png alt="Inverted Pendulum platform"></div><a href=/img/pendulum_platform.jpg itemprop=contentUrl></a><figcaption><p>Inverted Pendulum platform</p></figcaption></figure></div><h2 id=head-electronics>Head electronics</h2><h3 id=microcontroller>Microcontroller</h3><p>The controller is a Microstick II board equipped with a dsPIC 33EP128MC202 running at $\approx 70\ MIPS$. It is powered through the USB modified cable which <strong>provide only the power supply</strong> from 4 AA batteries hold in the base.</p><div class=box style=max-width:80%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pendulum_top.png alt="A prototyping board support a Microstick II board with the *dsPIC 33EP128MC202*. A sensor board from drotek endowing the *ICM-20608* inertial sensor is screwed on the base board."></div><a href=/img/pendulum_top.png itemprop=contentUrl></a><figcaption><h4>Microcontroller and sensor on top of the inverted pendulum</h4><p>A prototyping board support a Microstick II board with the *dsPIC 33EP128MC202*. A sensor board from drotek endowing the *ICM-20608* inertial sensor is screwed on the base board.</p></figcaption></figure></div><h3 id=imu-sensor>IMU sensor</h3><p>The unique sensor used is a 6 DoF<sup class=footnote-ref id=fnref:DoF><a href=#fn:DoF>3</a></sup> sensor: the ICM-20608 from invensense mounted on a <a href=https://store.drotek.com/sensors/779-imu-6dof-icm20608-invensense-pcb-8944595424761.html>drotek board</a> provides:</p><ul><li>a 3 axis Accelerometers and</li><li>a 3 axis rate gyro.</li></ul><p>The ICM-20608 values are read all 6 values at $1kHz$ through an I2C interface clocked at $400kHz$. The I2C interface implemented through the I2C blocks for dsPIC enable hot plug of the sensor: The microcontroller initialize the sensor each time this last is detected on the I2C bus. Others sensor boards were tested using MPU9250 or MPU6050 chips. The GY-91 board is currently one widespread board and has 10 DoF<sup class=footnote-ref id=fnref:3-acceletometers-3-rate-gyor-3-magnetometers-and-one-pressure-sensor><a href=#fn:3-acceletometers-3-rate-gyor-3-magnetometers-and-one-pressure-sensor>0</a></sup>.</p><ul><li>The accelerometer is configured with a range of $\pm 8g$ low pass filtered at $99Hz$.</li><li>The rage gyro is configured with a range of $\pm 500 \deg/s$ low pass filtered at $250Hz$.</li></ul><p>The data fusion algorithm in the simulink IMU<sup class=footnote-ref id=fnref:IMU><a href=#fn:IMU>4</a></sup> sub-system perform a data fusion algorithm to reconstruct a drift-free absolute quaternion angular position (except on the yaw angle when magnetometer is not available). The drift-free pitch angle is the only one requierd to stabilize the pendulum.</p><h3 id=UARTINTERFACE>UART interface</h3><p>The PCB board provides a $3.3V$ regulator and 4 pin extra interface ( GND, +3.3v, Tx, Rx ) to connect either an UART <a href=https://github.com/d-ronin/openlager/wiki>data-logger</a> or <a href=http://ardupilot.org/copter/docs/common-sik-telemetry-radio.html#common-sik-telemetry-radio>radio link</a> for telemetry module or an <a href=https://www.frsky-rc.com/product/xsr/>RC receiver</a> capable of S.BUS, S.Port or P.Port protocol (all UART based).</p><h2 id=hw_trolley>Base trolley</h2><h3 id=motors>Motors</h3><p>The base trolley is based on low cost a 2-wheel remote control toy. Its electronics is removed. Two pairs of wires power the two DC motors in either direction through an L298N H bridge external module.</p><div class="gallery caption-position-bottom caption-effect-slide hover-effect-zoom hover-transition" itemscope itemtype=http://schema.org/ImageGallery><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(https://lubin.kerhuel.eu//img/pendulum_toysrus_flywheels_package.jpg)><img itemprop=thumbnail src=/img/pendulum_toysrus_flywheels_package.jpg alt="FlyWheels toy package"></div><a href=/img/pendulum_toysrus_flywheels_package.jpg itemprop=contentUrl></a><figcaption><h4>FlyWheels toy package</h4><p>FlyWheels toy package</p></figcaption></figure></div><div class=box><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(https://lubin.kerhuel.eu//img/pendulum_toysrus_flywheels_open.jpg)><img itemprop=thumbnail src=/img/pendulum_toysrus_flywheels_open.jpg alt="Two DC motors"></div><a href=/img/pendulum_toysrus_flywheels_open.jpg itemprop=contentUrl></a><figcaption><h4>Two DC motors</h4><p>Two DC motors</p></figcaption></figure></div></div><h3 id=power-electronics>Power electronics</h3><p>The L298N H bridge controls two DC motors. For each motor:</p><ul><li>Two logic signals set the motor state: direction, brake, or free-wheels.</li><li>One logic signal power-up the motor depending on to the state defined. This third signal is modulated with a 100Hz square periodic signal (PWM) whose duty cycle vary from 0% to 100%. It sets the torque for the motor.</li></ul><p>The flat multicolor rubbon connects 6 logic control signal (3 for each motor) from the Microstick II dsPIC to the input of the L298N H bridge.</p><div class=box style=max-width:60%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pendulum_base.png alt="A *L298N H bridge* (for arduino) power board drives the two DC motors of a modified *FlyWheels* toy. *Four AA batteries* powers the pendulum."></div><a href=/img/pendulum_base.png itemprop=contentUrl></a><figcaption><h4>Base trolley of the inverted pendulum</h4><p>A *L298N H bridge* (for arduino) power board drives the two DC motors of a modified *FlyWheels* toy. *Four AA batteries* powers the pendulum.</p></figcaption></figure></div><h3 id=batteries>Batteries</h3><p>Four $1.2V$ AA NiMh batteries are dispatched on both side of the trolley. $\approx 4.8V$ powers the motors and the electronics. The black and red wires from the trolley to the top of the pendulum powers the Microstick II electronic and sensors.</p><p>The pendulum model is composed of two intertwined sub-system:</p><ul><li>The pendulum*, with 1 rotation DoF<sup class=footnote-ref id=fnref:DoF><a href=#fn:DoF>3</a></sup> $\theta$ angle around the wheels axis</li><li>The trolley*, with 1 translation DoF<sup class=footnote-ref id=fnref:DoF><a href=#fn:DoF>3</a></sup> $x$ position.</li></ul><h1 id=pendulum-model>Pendulum Model</h1><h2 id=equations>Equations</h2><p>Applying the Dynamic fundamental law:
$$ \sum \vec{Force} = m.\vec{a} $$</p><p>We model the three forces which are the weight $\vec{P}$, the Friction $\vec{F}$ which slow down the pendulum, and the Reaction $\vec{R}$ from the rod:</p><p>$$ \underbrace{ -mg\vec{j} }_{\vec{P}} \
- \ \underbrace{ k \frac{\partial \vec{r}}{\partial t} }_{\vec{F}} \
+ \ \underbrace{ mg\vec{j} . \vec{r} + \underbrace{Ctfg . \vec{r}}_{\text{Centrifugal}} }_{\vec{R}} = ml \frac{\partial^2\vec{ r }}{\partial t^2}
$$</p><p>With $ \{ \vec{i},\vec{j} \} $ the earth reference frame and $ \{ \vec{r},\vec{n} \} $ the pendulum frame (rod and normal direction).</p><p>$$
\left\{ \begin{array}{rcl}
\vec{i} &amp; = &amp; \vec{n} . cos(\theta) - \vec{r} . sin(\theta) \\\
\vec{j} &amp; = &amp; \vec{n} . sin(\theta) + \vec{r} . cos(\theta)
\end{array} \right.
$$</p><p>With</p><p>$$
\begin{array}{rcl}
k \frac{\partial \vec{r}}{\partial t} &amp; = &amp; -k \dot{\theta} \vec{n} \\<br>\\\<br>ml \frac{\partial^2\vec{ r }}{\partial t^2} &amp; = &amp; -ml \frac{\partial }{\partial t} \left( \dot{\theta} \vec{n} \right) \\<br>&amp; = &amp; -ml \ddot{\theta} \vec{n} - ml\dot{\theta}^2 \vec{r}
\end{array}
$$</p><p>Separating each axis $ \{ \vec{r},\vec{n} \} $ we obtain:
$$
\left\{ \begin{array}{rcl}
\ddot{\theta} + \frac{km}{l}\dot{\theta} - \frac{g}{l} . sin(\theta) = 0 \\\
ml\dot{\theta}^2 + Ctfg = 0
\end{array} \right.
$$</p><p>The second equation provides the centrifugal force counteracted by the pendulum rod.</p><p>The first differential equation allows solving the angle $\theta$ evolution. It can be linearized with $sin(\theta) \approx \theta$ when the pendulum is up near $0$, or with $sin(\theta) \approx - (\theta - \pi)$ when the pendulum is down near $\pi$.</p><p>In the laplace domain:
$$ \theta(s) \left ( \frac{1}{w_n^2}s^2 + \frac{2 \zeta}{w_n}s \pm 1 \right ) = 0 $$</p><p>The pendulum transfert function $F_p = \frac{\theta(s)}{E(s)}$ with a null input $E(s) = 1$
$$ F_p(s) = \frac{1}{ \frac{1}{w_n^2}s^2 + \frac{2 \zeta}{w_n}s \pm 1 } $$</p><p>Using $\pm 1 \rightarrow +1$ when the pendulum is down side (stable) and $-1$ when up side (unstable).</p><p>When the pendulum is up-side down (thus stable situation), the resulting $2^{nd}$ order system is characterized by:</p><ul><li>its natural oscillation frequency $w_n = \sqrt{ \frac{g}{l} } $ which depends only of the length $l$ of the pendulum (trolley wheels axis to center of mass of the pendulum) and</li><li>the damping factor $\zeta$.</li></ul><p>The parameter $l$ could be measured from the platform hardware but the damping factor $\zeta$ depends on friction and cannot be measured.
Thus both $l$ and $\zeta$ are determined by an identification on the free oscillating pendulum</p><h2 id=identification>Identification</h2><p>The pendulum is placed up-side-down between two chair back. Motors are off ; the pendulum is let free to oscillate. The initial angle is $\theta \approx \frac{\pi}{2}$ (almost horizontal). It oscillates close to its natural frequency $w_n$ until the damping friction ($\zeta$) stop the oscillations. The $1kHz$ sampled angular speed and accelerations are recorded onboard an <a href=https://github.com/d-ronin/openlager/wiki>openlager</a> board connected on the <a href=#UARTINTERFACE>UART</a> interface.</p><table><thead><tr><th align=center>Pendulum Parameters</th><th align=center>Identified Value</th></tr></thead><tbody><tr><td align=center>$l$</td><td align=center>$0.45 m$</td></tr><tr><td align=center>$k$</td><td align=center>$0.4$</td></tr><tr><td align=center>$w_n = \sqrt{\frac{g}{l}}$</td><td align=center>$0.37 rad.s^{-1}$ ( $2.33 Hz$ )</td></tr></tbody></table><p>Recorded data fed a Simulink model which reconstruct the pendulum angle with a data fusion IMU algorithm. Then the pendulum angular oscillations is compard against a pendulum model output. The model parameters $l$ and $\zeta$ are tuned to best fit with the experimental data. See results in the table.</p><h1 id=trolley-model>Trolley Model</h1><h2 id=equations-1>Equations</h2><p>The translational movement of the trolley is modeled as a $1^{st}$ order system characterized by its time constant $\tau$. This dynamic include the motor dynamics when it is loaded with the trolley considering the pendulum as vertical. The model do not consider the impact of the non vertical pendulum on the trolley translation, nor the couple applied on the pendulum when motors applies a couple on the wheels.</p><p>$$ x(s) = \frac{1}{\tau s + 1} $$</p><table><thead><tr><th align=center>Trolley Parameter</th><th align=center>Estimated Value</th></tr></thead><tbody><tr><td align=center>$\tau$</td><td align=center>$0.3s$</td></tr></tbody></table><p>The trolley is not equipped with any sensors. Thus the parameters $\tau$ is guessed instead of identified.</p><p>Still the pendulum model including the trolley is simulated with its feedback loop controller and results are compared against recorded data of the real systme running the same feedback loop controller. The simulated pendulum states are re-initialised periodically ($\approx 2s$) with the real pendulum states as the model would diverge otherwise due to perturbations not modeled and model discripancies. Correctness of the model can be checked between theses periodic re-initialisation.</p><h2 id=identification-1>Identification</h2><h1 id=controller>Controller</h1><p><code>Stabilization overview:</code> The microcontroller computes the angle of the pendulum from the inertial sensor measurements (accelerometers and rate gyro). A feedback loop stabilize the pendulum up right while maintaining the pendulum position still. The pendulum translation is estimated through an internal dynamic model of the trolley stimulated with a copy of the DC motor command. The pendulum slow translations reflect the drift of the internal estimation of the displacement.</p><p>Video of the inverted Pendulum when it encounters a wall:<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=//player.vimeo.com/video/309876329 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></p><p>Another way to stabilize a pendulum with an electric see-saw (<a href=https://sciencedemonstrations.fas.harvard.edu/presentations/inverted-pendulum>video</a>).</p><div class=footnotes><hr><ol><li id=fn:DIY>Do It Yourself
<a class=footnote-return href=#fnref:DIY><sup>^</sup></a></li><li id=fn:LQR>Linear Quadratic Regulator
<a class=footnote-return href=#fnref:LQR><sup>^</sup></a></li><li id=fn:DoF>Degree of Freedom
<a class=footnote-return href=#fnref:DoF><sup>^</sup></a></li><li id=fn:IMU>Inertial Measurement Unit
<a class=footnote-return href=#fnref:IMU><sup>^</sup></a></li></ol></div></div></div><div class=body-footer>Last updated on Jan 31, 2019</div></article><footer class=site-footer><p class=powered-by>&copy; 2019 Lubin Kerhuel &middot;
Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=/js/mathjax-config.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin=anonymous async></script><script>hljs.initHighlightingOnLoad();</script><script>const search_index_filename="/index.json";const i18n={'placeholder':"Search...",'results':"results found",'no_results':"No results found"};const content_type={'post':"Posts",'project':"Projects",'publication':"Publications",'talk':"Talks"};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add();</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.07fbebbbf71b021c8836e1d7ecffa489.js></script></body></html>