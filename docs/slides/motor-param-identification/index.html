<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.5.0 for Hugo"><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hua5ed3a3c5aab9d478a9217a3fd35ab73_87443_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hua5ed3a3c5aab9d478a9217a3fd35ab73_87443_192x192_fill_lanczos_center_3.png><link rel=canonical href=https://lubin.kerhuel.eu/slides/motor-param-identification/><title>Motor Parameters Identification | Rapid Control Prototyping</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/dist/reveal.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/dist/theme/black.min.css><link rel=stylesheet href=/css/libs/chroma/dracula.min.css><link rel=stylesheet href=/css/reveal_custom.min.css></head><body><div class=reveal><div class=slides><section><h2 id=parameters-identification>Parameters Identification</h2><h3 id=for-motor-pmsm>for motor PMSM</h3><h4 id=dspic-embedded>dsPIC embedded</h4><p><sub><sub><sub>parts comes from joint work with Dr. R.Delpoux from INSA Lyon (Fr)</sub></sub></sub></p></section><section><h2 id=2-steps>2 steps</h2><ul><li>Stand-still Identification (coarse)<ul><li>{R, L}</li><li>Starts Sliding Mode Observer with current control loop</li></ul></li><li>Runtime Identification (refined in situe)<ul><li>{R, L and Ke}</li></ul></li></ul></section><section><h2 id=stand-still-identification>Stand-still Identification</h2><ul><li><p>R during rotor &ldquo;alignement&rdquo; (800ms)</p></li><li><p>L during current relaxation phase (300ms)</p></li><li><p>Assuming: $Ts &lt;&lt; \tau$</p></li></ul><p>with $Ts$ Sample time and $\tau = \frac{L}{R}$</p></section><section><h2 id=relaxation-phase>relaxation phase</h2><p>$A \exp(-\frac{nT_s}{\tau})$</p><p>with</p><p>$ \exp(-\frac{nT_s}{\tau}) = 1 -\frac{nT_s}{\tau} + \frac{(\frac{nT_s}{\tau})^2}{2!} + \ldots$</p></section><section><h2 id=initialisation-sequence>initialisation sequence</h2><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./Vdq_Idq_StartupCloseUp.png alt=./Vdq_Idq_StartupCloseUp.png loading=lazy data-zoomable></div></div></figure>up: $V_{dq}$ down: $I_{dq}$</p></section><section><h2 id=relaxation-phase-1>relaxation phase</h2><p>$ \frac{x_{n+1} - x_n}{x_n} = \exp(-\frac{Ts}{\tau})- 1$</p><p>$ \frac{x_{n+1} - x_n}{x_n} \approx -\frac{Ts}{\tau} + \frac{(\frac{Ts}{\tau})^2}{2!} - \frac{(\frac{Ts}{\tau})^3}{3!} + \ldots$</p><p>$ \frac{x_{n+1} - x_n}{x_n} \approx -\frac{Ts}{\tau} + O(\frac{Ts}{\tau}^2)$</p></section><section><h2 id=relaxation-phase-2>relaxation phase</h2><p>$ \frac{x_{n+1} - x_n}{x_{n+1} + x_n} = -\tanh(\frac{Ts}{2\tau}) $</p><p>$ \frac{x_{n+1} - x_n}{x_{n+1} + x_n} \approx -\frac{Ts}{2\tau} + \frac{Ts^3}{24\tau^3} + \ldots$</p><ul><li>Increased precision (Mitigate denominator noise)</li><li>Increased accuracy ($O(\frac{Ts}{\tau}^3$)</li></ul></section><section><h2 id=relaxation-phase-3>relaxation phase</h2><p>Averaging on one or more relaxation phase (for 300ms)</p><p>$ \frac{1}{N}\sum_n \frac{x_{n+1} - x_n}{x_{n+1} + x_n} \approx -\frac{Ts}{2\tau} + O(\frac{Ts}{\tau}^3)$)</p></section><section><h2 id=initialisation-sequence-1>initialisation sequence</h2><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./Vdq_Idq_WholeSequence.png alt=./Vdq_Idq_WholeSequence.png loading=lazy data-zoomable></div></div></figure>up: $V_{dq}$ down: $I_{dq}$</p></section><section><h2 id=static-ident-results>Static ident results</h2><h3 id=long-hurst-motor>Long Hurst motor</h3><ul><li>R = 0.671 Ohm L = 0.229 mH</li><li>R = 0.678 Ohm L = 0.271 mH</li><li>R = 0.663 Ohm L = 0.198 mH</li><li>R = 0.678 Ohm L = 0.271 mH</li><li>R = 0.670 Ohm L = 0.227 mH</li><li>R = 0.671 Ohm L = 0.237 mH</li><li>R = 0.647 Ohm L = 0.185 mH</li></ul></section><section><h2 id=static-ident-results-1>Static ident results</h2><h3 id=short-hurst-motor>Short Hurst motor</h3><ul><li>R = 2.561 Ohm L = 1.741 mH</li><li>R = 2.582 Ohm L = 1.610 mH</li><li>R = 2.699 Ohm L = 1.871 mH</li><li>R = 2.588 Ohm L = 2.022 mH</li><li>R = 2.776 Ohm L = 2.180 mH</li><li>R = 2.672 Ohm L = 1.606 mH</li><li>R = 2.709 Ohm L = 1.629 mH</li></ul></section><section><h2 id=next-step>Next Step</h2><p>Parameters {R,L} are good enough to start:</p><ul><li>current control loop</li><li>Sliding Mode Observer</li></ul><p>-> refine parameteres during runtime</p></section><section><h2 id=running-identification>running identification</h2><p>Motor electric equations when set</p><p>$\begin{bmatrix} v_d\\ v_q \end{bmatrix} =
\begin{bmatrix} i_d & -\omega i_q & 0 \\ i_q & \omega i_d & \omega \end{bmatrix}
\begin{bmatrix} R \\ L \\ Ke \end{bmatrix} $</p><p><sub><sub><sub>following part from joint work with Dr. R.Delpoux from INSA Lyon (Fr, <a href=https://rtdc.ctrl-elec.fr/ target=_blank rel=noopener>Lab ampere</a>)</sub></sub></sub></p></section><section><h2 id=running-identification-1>running identification</h2><p>$\underbrace{\begin{bmatrix} v_d\\ v_q \end{bmatrix}}_y =
\underbrace{\begin{bmatrix} i_d & -\omega i_q & 0 \\ i_q & \omega i_d & \omega \end{bmatrix}}_A
\underbrace{\begin{bmatrix} R \\ L \\ Ke \end{bmatrix}}_x $</p><p>Minimum Mean Square Error (MMSE): $\min_x\left(y-Ax\right)^2$</p><p>best fit for the model might not be the best real parameters values</p></section><section><h2 id=running-identification-2>running identification</h2><p>$\underbrace{\begin{bmatrix} v_d\\ v_q \end{bmatrix}}_y =
\underbrace{\begin{bmatrix} i_d & -\omega i_q & 0 \\ i_q & \omega i_d & \omega \end{bmatrix}}_A
\underbrace{\begin{bmatrix} R \\ L \\ Ke \end{bmatrix}}_x $</p><p>$\min_x\left(y-Ax\right)^2$</p><p>$\frac{d}{dx}\left( y^ty - 2y^tAx + x^tA^tAx \right) = 0$</p><p>$ (A^tA)x_{best} = y^tA$</p><p>$x_{best} = -(A^tA)^{-1}*y^tA$</p></section><section><h2 id=implementation>implementation</h2><p>$\underbrace{A^tA}_{\text{3x3 matrix}} = \sum_n \begin{bmatrix} i_d^n & i_q^n \\ -\omega^n i_q^n & \omega i_d^n \\ 0 & \omega^n \end{bmatrix}
\begin{bmatrix} i_d^n & -\omega^n i_q^n & 0 \\ i_q^n & \omega i_d^n & \omega^n \end{bmatrix}
$</p><p>$\underbrace{y^tA}_{\text{3x1 vector}} = \sum_n \begin{bmatrix} v_d^n & v_q^n \end{bmatrix}
\begin{bmatrix} i_d^n & -\omega^n i_q^n & 0 \\ i_q^n & \omega i_d^n & \omega^n \end{bmatrix} $</p><p>Solve $Ax=b$ linear system with Cholesky factorization</p></section><section><h2 id=simulink-block-cholesky>Simulink block Cholesky</h2><p>Solve $Ax=b$ linear system with Cholesky factorization</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./Simulink_Cholesky.png alt=./Simulink_Cholesky.png loading=lazy data-zoomable></div></div></figure></p></section><section><h2 id=remarks>remarks</h2><ul><li>requires > 3 states (speed, load, $I_d injection$&mldr;)</li><li>use data history from the beginning</li><li>better results with higher current (i.e. load)</li></ul><p>$(y-Ax)$ error indicate parameters mismatch/changes</p></section><section><h2 id=runtime-ident-results>runtime ident results</h2><h3 id=short-hurst>short hurst</h3><ul><li>R = 2.655 Ohm L = 2.554 mH Phif = 4.320 V/Krpm</li><li>R = 2.699 Ohm L = 2.604 mH Phif = 4.290 V/Krpm</li><li>R = 2.696 Ohm L = 2.630 mH Phif = 4.293 V/Krpm</li><li>R = 2.772 Ohm L = 2.592 mH Phif = 4.277 V/Krpm</li><li>R = 2.750 Ohm L = 2.609 mH Phif = 4.281 V/Krpm</li><li>R = 2.666 Ohm L = 3.885 mH Phif = 4.278 V/Krpm</li><li>R = 2.789 Ohm L = 2.583 mH Phif = 4.252 V/Krpm</li></ul></section><section><h2 id=runtime-ident-results-1>runtime ident results</h2><h3 id=long-hurst>long hurst</h3><ul><li>R = 0.571 Ohm L = 0.305 mH Phif = 4.199 V/Krpm</li><li>R = 0.648 Ohm L = 0.338 mH Phif = 4.192 V/Krpm</li><li>R = 0.604 Ohm L = 0.248 mH Phif = 4.199 V/Krpm</li><li>R = 0.640 Ohm L = 0.271 mH Phif = 4.197 V/Krpm
after reset (remove standstill data history)</li><li>R = 0.487 Ohm L = 0.242 mH Phif = 4.245 V/Krpm</li><li>R = 0.472 Ohm L = 0.257 mH Phif = 4.250 V/Krpm</li><li>R = 0.480 Ohm L = 0.280 mH Phif = 4.246 V/Krpm</li><li>R = 0.481 Ohm L = 0.280 mH Phif = 4.245 V/Krpm</li></ul></section><section><h2 id=go-further>go further</h2><p>Other method tested without angle requirement</p><p>requires ${v_\alpha, v_\beta, i_\alpha, i_\beta}$</p><p>Works in open-loop during startup.</p><p>Require solving system with constraints.</p></section><section><p>et voil√† !</p></section><section><h2 id=appendix>Appendix</h2></section><section><h2 id=tasking>Tasking</h2><section data-background-image=./Scope_MultiTasking_SchedulerIllustration.png data-background-opacity=1 data-background-position=center data-background-size=contain>></section></section></div></div><script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/dist/reveal.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/plugin/markdown/markdown.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/plugin/notes/notes.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/plugin/search/search.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/plugin/math/math.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.2.1/plugin/zoom/zoom.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/plugin.js integrity="sha256-M6JwAjnRAWmi+sbXURR/yAhWZKYhAw7YXnnLvIxrdGs=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.js integrity="sha256-l14dklFcW5mWar6w/9KaW0fWVerf3mYr7Wt0+rXzFAA=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.css integrity="sha256-0fU8HKLaTjgzfaV9CgSqbsN8ilA3zo6zK1M6rlgULd8=" crossorigin=anonymous><script src=/js/wowchemy-slides.js></script></body></html>