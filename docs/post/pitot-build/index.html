<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.3.1"><meta name=author content="Lubin Kerhuel"><meta name=description content="DIY miniature pitot-tube with mechanic and electronics description and in flight sensor measurements. Air-speed performance is compared against a GPS ground speed reference. Estimate wind strength and direction mixing GPS and pitot outputs."><link rel=alternate hreflang=en-us href=https://lubin.kerhuel.eu/post/pitot-build/><meta name=theme-color content="hsl(195, 90%, 58%)"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.0/css/all.css integrity=sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/vs2015.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/vs2015.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href="//fonts.googleapis.com/css?family=Istok+Web|Roboto:400,400italic,700|Roboto+Mono"><link rel=stylesheet href=/css/academic.min.ff0aa96133f069a19898894f56a4c81d.css><link rel=stylesheet href=/css/academic.dfef8698ccd0c0cbec1887b1b4db4f38.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-90899-5','auto');ga('require','eventTracker');ga('require','outboundLinkTracker');ga('require','urlChangeTracker');ga('send','pageview');</script><script async src=//www.google-analytics.com/analytics.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin=anonymous></script><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png href=/img/icon.png><link rel=apple-touch-icon type=image/png href=/img/icon-192.png><link rel=canonical href=https://lubin.kerhuel.eu/post/pitot-build/><meta property=twitter:card content=summary_large_image><meta property=twitter:site content=@LubinKerhuel><meta property=twitter:creator content=@LubinKerhuel><meta property=og:site_name content="Rapid Control Prototyping (RCP)"><meta property=og:url content=https://lubin.kerhuel.eu/post/pitot-build/><meta property=og:title content="Miniature air-speed sensor for RC plane or UAVs. | Rapid Control Prototyping (RCP)"><meta property=og:description content="DIY miniature pitot-tube with mechanic and electronics description and in flight sensor measurements. Air-speed performance is compared against a GPS ground speed reference. Estimate wind strength and direction mixing GPS and pitot outputs."><meta property=og:image content=https://lubin.kerhuel.eu/post/pitot-build/featured.jpg><meta property=og:locale content=en-us><meta property=article:published_time content=2019-05-28T00:00:00&#43;00:00><meta property=article:modified_time content=2019-06-07T00:36:27&#43;02:00><title>Miniature air-speed sensor for RC plane or UAVs. | Rapid Control Prototyping (RCP)</title></head><body id=top data-spy=scroll data-target=#TableOfContents data-offset=71 class=dark><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off role=textbox spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id=navbar-main><div class=container><a class=navbar-brand href=/>Rapid Control Prototyping (RCP)</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></div></nav><article class=article itemscope itemtype=http://schema.org/Article><div class="article-header d-xl-none"><div class=featured-image style=background-image:url(/post/pitot-build/featured_hue2410cb1bc24f8d7fa102de58ba475d7_63809_800x0_resize_q90_lanczos.jpg)></div><span class=article-header-caption>Carbon pitot tube attached to the wing with a magnet.</span></div><div class="container-fluid split-header d-none d-xl-block"><div class=row><div class=col-6><div class=split-header-content><h1 itemprop=name>Miniature air-speed sensor for RC plane or UAVs.</h1><p class=page-subtitle>Mechanic, electronic, test of a miniature Pitot-Darcy-Prandtl sensor embedded in drone or RC plane</p><meta content="2019-05-28 00:00:00 &#43;0000 UTC" itemprop=datePublished><meta content="2019-06-07 00:36:27 &#43;0200 CEST" itemprop=dateModified><div class=article-metadata><div><span itemprop="author name" itemtype=http://schema.org/Person><a href=/authors/lubin/>Lubin Kerhuel</a></span></div><span class=article-date>Last updated on
<time>Jun 7, 2019</time></span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder"></i><a href=/categories/electronics/>Electronics</a>, <a href=/categories/sensor/>sensor</a></span></div><div class="btn-links mb-3"><a class="btn btn-outline-primary my-1 mr-1" href=/project/autopilot-plane/>Project</a></div><div class=share-box aria-hidden=true><ul class=share><li><a class=twitter href="https://twitter.com/intent/tweet?text=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs.&amp;url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f" target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a class=facebook href="https://www.facebook.com/sharer.php?u=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f" target=_blank rel=noopener><i class="fab fa-facebook-f"></i></a></li><li><a class=linkedin href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f&amp;title=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs." target=_blank rel=noopener><i class="fab fa-linkedin-in"></i></a></li><li><a class=weibo href="http://service.weibo.com/share/share.php?url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f&amp;title=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs." target=_blank rel=noopener><i class="fab fa-weibo"></i></a></li><li><a class=email href="mailto:?subject=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs.&amp;body=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f"><i class="fas fa-envelope"></i></a></li></ul></div></div></div><div class=col-6><div class=split-header-image><img src=/post/pitot-build/featured_hue2410cb1bc24f8d7fa102de58ba475d7_63809_680x500_fill_q90_lanczos_left.jpg itemprop=image alt>
<span class=article-header-caption>Carbon pitot tube attached to the wing with a magnet.</span></div></div></div></div><div class="article-container d-xl-none"><h1 itemprop=name>Miniature air-speed sensor for RC plane or UAVs.</h1><p class=page-subtitle>Mechanic, electronic, test of a miniature Pitot-Darcy-Prandtl sensor embedded in drone or RC plane</p><meta content="2019-05-28 00:00:00 &#43;0000 UTC" itemprop=datePublished><meta content="2019-06-07 00:36:27 &#43;0200 CEST" itemprop=dateModified><div class=article-metadata><div><span itemprop="author name" itemtype=http://schema.org/Person><a href=/authors/lubin/>Lubin Kerhuel</a></span></div><span class=article-date>Last updated on
<time>Jun 7, 2019</time></span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder"></i><a href=/categories/electronics/>Electronics</a>, <a href=/categories/sensor/>sensor</a></span><div class=share-box aria-hidden=true><ul class=share><li><a class=twitter href="https://twitter.com/intent/tweet?text=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs.&amp;url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f" target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a class=facebook href="https://www.facebook.com/sharer.php?u=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f" target=_blank rel=noopener><i class="fab fa-facebook-f"></i></a></li><li><a class=linkedin href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f&amp;title=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs." target=_blank rel=noopener><i class="fab fa-linkedin-in"></i></a></li><li><a class=weibo href="http://service.weibo.com/share/share.php?url=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f&amp;title=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs." target=_blank rel=noopener><i class="fab fa-weibo"></i></a></li><li><a class=email href="mailto:?subject=Miniature%20air-speed%20sensor%20for%20RC%20plane%20or%20UAVs.&amp;body=https%3a%2f%2flubin.kerhuel.eu%2fpost%2fpitot-build%2f"><i class="fas fa-envelope"></i></a></li></ul></div></div><div class="btn-links mb-3"><a class="btn btn-outline-primary my-1 mr-1" href=/project/autopilot-plane/>Project</a></div></div><div class=article-container><div class=article-style itemprop=articleBody><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=/js/load-photoswipe.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css integrity=sha384-yX+tSqQp3yF8BiTuLLOwNyaqtmZ9yFQT7IYg7U9YU9Dz/JDlh6JJQmNClCmvYl+b crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css integrity=sha384-R6P/wJIrxjHcm//YCjb0S6rRgebsNn3u6U4NxVI8R03iSPAR5CwPqoq1n6U/tjFE crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js integrity=sha384-jkeJ/ETDRD/P4Y3I3CQi1QIwrEJjR9GdAZV2/aqDwwgA5ldCNiExYJeBwKyQC/+q crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js integrity=sha384-HotcxRWS6/oszHPwknjGnd066fV8+ycnO5TXDcOscFWvTtaiCtEEv+9s5Qrn1iJD crossorigin=anonymous></script><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><h2 id=principle>Principle</h2><p>A Pitot-Darcy tube is an air speed sensor commonly used in aviation. It consists of a tube pointing in the forward direction. When the sensor moves forward a stop pressure is created at its top. A differential pressure is measured between the top of the tube and the ambient pressure. One variant named from its inventor Prandtl tube has static air ports directly on the side of the tube.</p><p>The pressure measured is linear to the square of the air speed : $P_t = P_s + \frac{1}{2}\rho v^2$ where $P_t$ and $P_s$ are the pressure in Pa, $\rho$ is the fluid density constant typically in $[1.14 \ 1.34]$ depending on temperature &amp; altitude, and $v$ the speed in $m.s^{-1}$. The differential pressure measured is $P_d = P_t-P_s$.</p><h2 id=prandtl-tube>Prandtl tube</h2><p>Prandtl tube is made of an inner tube placed within an outer tube. At their top, both tubes are centered. Space between the two tubes is hermetically filled in with an epoxy adhesive (Araldite or equivalent) on few mm near the top. The side of the outer tube is drilled to sense the static pressure. At the bottom, the inner tube which is longer act as a connector for the dynamic pressure sensor and a tiny tube is added next to create another connector to the static pressure which lies in the empty space between the two tube.</p><p>The static pressure holes should be placed at a minimum distance from the top due to airflow perturbations. A distance 4 times the diameter of the outer tube is retains here.</p><p>First test was done using brass tube. Inner tube is 1mm inside, 2mm outside. Outer tube was 3mm inside, 4mm outside. A lighter pitot tube was tested using one inner brass tube (1mm/2mm) with a carbon outer tube (3mm/5mm).</p><link rel=stylesheet href=/css/hugo-easy-gallery.css><div class=box style=max-width:80%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-build-brasstubes.jpg alt="Tube alfer from Leroy Merlin. Inner tube is 2mm/1mm. Outer tube is 4mm/3mm (d=4mm).  Outer tube length is m=86mm (21d). Four 1mm width holes are at l=16mm (4d) from the top."></div><a href=/img/pitot-darcy-prandtl-build-brasstubes.jpg itemprop=contentUrl></a><figcaption><h4>Brass inner and outer tubes composing the pitot tube.</h4><p>Tube alfer from Leroy Merlin. Inner tube is 2mm/1mm. Outer tube is 4mm/3mm (d=4mm). Outer tube length is m=86mm (21d). Four 1mm width holes are at l=16mm (4d) from the top.</p></figcaption></figure></div><p>References:</p><ul><li><a href=http://naca.central.cranfield.ac.uk/reports/1957/naca-report-1303.pdf>report</a> by W.Gracey on the impact of the various shape on the measurement.</li><li><a href=https://www.planete-sciences.org/espace/IMG/pdf/tube_de_pitot.pdf>report (french)</a> from ANSTJ with general information on pitot sensor.</li><li><a href=http://voiletech.free.fr/skyassistant/pitot.htm>website (French)</a> from Rémi Bourgin with experimental pitot tube for RC plane</li></ul><h2 id=electronics>Electronics</h2><h3 id=sensitivity-requirements-and-pressure-sensor>Sensitivity requirements and Pressure sensor</h3><p>The differential pressure measured vary with the square of the speed. RC plane speed can be quite low. Challenge is to be sensitive enough to obtain good measurement even in the low speed range of few meters per seconds.</p><p>The <a href=https://www.nxp.com/part/MP3V5004DP>MP3V5004dp</a> from NXP is a sensitive differential pressure sensor. Its differential measurement range goes from 0 to 3.92 kPa. The analog output is ratio-metric and swing from 0.6V to 3V ($\Delta V =2.4V$). For reference, 1 kPa is approximately the pressure of 10cm of water.</p><p>We are interested in speed range varying from $0$ to $25 m.s^{-1}$ ($90km/h$) which correspond to a maximum differential pressure of 3.75 cm of water, or 0.375 kPa. The MP3V5004DP sensor is used in 10% of its nominal range.</p><p>Table below provide theoretical differential pressure expected for various speed using $P_{diff} = \frac{1}{2}\rho v^2$ with $\rho=1.2$.</p><table><thead><tr><th align=center>v (m/s)</th><th align=center>v (Km/h)</th><th align=center>$P_{diff}$ (Pa)</th><th align=center>~ $H_2O$ (cm)</th><th align=center><a href=https://www.nxp.com/part/MP3V5004DP>MP3V5004dp</a> &amp; <a href=https://www.microchip.com/wwwproducts/en/MCP3428>MCP3428</a> (0.2041Pa / LSB)</th></tr></thead><tbody><tr><td align=center>1</td><td align=center>3.6</td><td align=center>0.6</td><td align=center>0.006</td><td align=center>3</td></tr><tr><td align=center>2</td><td align=center>7.2</td><td align=center>2.4</td><td align=center>0.024</td><td align=center>12</td></tr><tr><td align=center>4</td><td align=center>14.4</td><td align=center>9.6</td><td align=center>0.096</td><td align=center>47</td></tr><tr><td align=center>7</td><td align=center>25.2</td><td align=center>29.4</td><td align=center>0.294</td><td align=center>144</td></tr><tr><td align=center>10</td><td align=center>36</td><td align=center>60</td><td align=center>0.6</td><td align=center>294</td></tr><tr><td align=center>15</td><td align=center>54</td><td align=center>135</td><td align=center>1.3</td><td align=center>661</td></tr><tr><td align=center>20</td><td align=center>72</td><td align=center>240</td><td align=center>2.4</td><td align=center>1176</td></tr><tr><td align=center>25</td><td align=center>90</td><td align=center>375</td><td align=center>3.75</td><td align=center>1837</td></tr><tr><td align=center>30</td><td align=center>108</td><td align=center>540</td><td align=center>5.4</td><td align=center>2646</td></tr><tr><td align=center>40</td><td align=center>144</td><td align=center>960</td><td align=center>9.6</td><td align=center><em>4704</em> (4095 sat)</td></tr></tbody></table><h3 id=signal-conditioning-and-conversion>Signal conditioning and conversion</h3><p>The pressure sensor is placed close (~10cm) to the pitot tube on the wing. The analog to digital conversion is also done on site to avoid noise pollution of analog signal. The <a href=https://www.microchip.com/wwwproducts/en/MCP3428>MCP3428</a> from Microchip is a high resolution sigma-delta converter with four differential inputs and a programmable gain factor from 1 to 8. It has a digital I2C interface to connect to the dsPIC.</p><p>The <a href=https://www.nxp.com/part/MP3V5004DP>MP3V5004dp</a> output analog signal is connected to the <a href=https://www.microchip.com/wwwproducts/en/MCP3428>MCP3428</a> Sigma-Delta ADC through a first order RC low pass filter with a cut off frequency at $28Hz$ ($R=5.6 kOhm$,$C=1\mu F$). The 2nd differential input is connected on a voltage divisor with 1.2k and 560 ohms to the 3.3V ref and GND. $10\mu F$ decoupling capacitor are used on power supply. The I2C bus lines are pulled up with 10kOhm and are connected to a 10pf capacitor protecting from glitches.</p><div class=box style=max-width:80%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-build-mp3v5004dp-mcp3428.jpg alt="Differential pressure sensor (MP3V5004dp) with Analog to Digital converter integrating a differential amplifier (MCP3428). The MCP3428 communicate with the microcontroller through an I2C BUS. A 3.3V voltage regulator adapt and filter out the 5V input voltage."></div><a href=/img/pitot-darcy-prandtl-build-mp3v5004dp-mcp3428.jpg itemprop=contentUrl></a><figcaption><h4>Pressure sensor and electronics mounted on a DIP adapter board.</h4><p>Differential pressure sensor (MP3V5004dp) with Analog to Digital converter integrating a differential amplifier (MCP3428). The MCP3428 communicate with the microcontroller through an I2C BUS. A 3.3V voltage regulator adapt and filter out the 5V input voltage.</p></figcaption></figure></div><h3 id=sensor-static-tests>Sensor static tests</h3><p>A 90 minutes lasting measurement is performed indoor without movements. Sensor output were logged at 100Hz. The figure below shows a slow drift. The sensor standard deviation measured on the overall measurement is 0.54 Pa (including the drift).</p><div class=box style=max-width:100%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-static-characteristic.png alt="90 minutes lasting static measurement indoor shows a slow drift and a standard deviation of 0.54 Pa."></div><a href=/img/pitot-darcy-prandtl-static-characteristic.png itemprop=contentUrl></a><figcaption><h4>Differential Sensor static characteristics</h4><p>90 minutes lasting static measurement indoor shows a slow drift and a standard deviation of 0.54 Pa.</p></figcaption></figure></div><p>The sensor is sensitive to its own orientation. Moving the sensor up-side down create an offset of (100 LSB; to be checked).</p><h2 id=installation>Installation</h2><p>A 2mm flexible tube originally used to protect fish lines connect the pitot tube with the sensor.</p><div class=box style=max-width:50%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-tubesoupledecathlon.jpg alt="Fishing Tube used to connect pressure MP3V5004dp sensor to pitot tube."></div><a href=/img/pitot-darcy-prandtl-tubesoupledecathlon.jpg itemprop=contentUrl></a><figcaption><h4>Flashmer – flexible Tube 2mm. Image from Decathlon (france)</h4><p>Fishing Tube used to connect pressure MP3V5004dp sensor to pitot tube.</p></figcaption></figure></div><p>One magnet is glued on the pitot tube. The pitot tube is attached to the plane through a 2nd magnet integrated into the wing. This flexible solution allows the tube to stay in place during flight, eject in case of hard landing reducing damages and is practical for storage and transportation.</p><div class=box style=max-width:100%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-wing-brass-mp3v5004dp-mcp3428.jpg></div><a href=/img/pitot-darcy-prandtl-wing-brass-mp3v5004dp-mcp3428.jpg itemprop=contentUrl></a><figcaption><h4>Brass pitot tube with its electronic board mounted on the bottom of the right Firstar 1600 wing.</h4></figcaption></figure></div><div class=box style=max-width:60%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-wing-carbon2.jpg alt="Outer tube is a 5mm carbon tube. Inner tube is a brass 2mm/1mm tube."></div><a href=/img/pitot-darcy-prandtl-wing-carbon2.jpg itemprop=contentUrl></a><figcaption><h4>Carbon-Brass pitot tube attached to the wing with a magnet.</h4><p>Outer tube is a 5mm carbon tube. Inner tube is a brass 2mm/1mm tube.</p></figcaption></figure></div><h2 id=results>Results</h2><h3 id=comparison-with-gps-ground-speed>Comparison with GPS ground speed</h3><p>The pitot tube differential pressure is converted to speed with $V=\sqrt{\frac{2}{\rho}*P_{diff}}$ with $\rho = 1.2$.</p><p>Matlab script converting raw MCP3428 to Pressure (Pa) and Speed (m/s):</p><pre><code class=language-matlab>% Pitot Calibration. P_pitot is the raw MCP3428 sensor output read from I2C bus.
P_pitot_cal =  0.2041* (double(P_pitot) + 1800);    % to Pa unit

% Compute Speed (m/s) from diff pressure (in Pa).
V_pitot = sqrt(max(0,(2/1.2) * P_pitot_cal));
</code></pre><p>The Ground Speed (GPS COG<sup class=footnote-ref id=fnref:COG><a href=#fn:COG>1</a></sup>) and the Air Speed (pitot) measurements are theoretically similar in absence of wind. In presence of a constant wind, the direction and strength can be estimated combining the airspeed with the ground speed and the plane yaw direction.</p><p>With the wind strength and direction known, the airplane ground speed (GPS) is obtained by adding the projected wind to the aircraft forward direction to the air speed (pitot). The figure below presents the air speed in dashed blue. The air-speed measurement shows a good sensitivity even at low speed. The reconstructed ground speed (thin black line) matches with the GPS ground speed (large grey line) which prove the accuracy of the measurement. The estimation of the wind strength and direction is described <a href=#wind-estimation>below</a>.</p><div class=box style=max-width:100%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-gps-wind-estimation.png alt="GPS (grey curve) and Pitot minus Wind (black curve) matches. Data log of the first 200s of the Firstar 1600 RC plane flight. On the black curve, the pitot is averaged and undersampled by group of 5 samples reducing its sampling rate from 250Hz to 50Hz. The GPS ground speed is correctly estimated based on the pitot tube measurement."></div><a href=/img/pitot-darcy-prandtl-gps-wind-estimation.png itemprop=contentUrl></a><figcaption><h4>GPS Speed over ground (large grey), Pitot air-speed (dashed blue) with parameter $\rho=1.2$. Pitot air-speed minus constant wind estimation (black curve)</h4><p>GPS (grey curve) and Pitot minus Wind (black curve) matches. Data log of the first 200s of the Firstar 1600 RC plane flight. On the black curve, the pitot is averaged and undersampled by group of 5 samples reducing its sampling rate from 250Hz to 50Hz. The GPS ground speed is correctly estimated based on the pitot tube measurement.</p></figcaption></figure></div><p>The remaining error might be sensor error, but also wind gust and GPS accuracy limitation particularly at estimating vertical speed changes (During flight, the plane speed was change through rapid dive to test the pitot tube on a wide range).</p><h3 id=wind-estimation>Wind estimation</h3><p>The comparison of the pitot tube with the GPS ground speed require to estimate the wind strength and direction.</p><p>The curve below shows the difference between the Ground speed (GPS) with the air speed (pitot) in function of the plane flight direction. This error (blue dashed points) fit with a sine wave which is the offset added by a wind constant in strength and direction.</p><div class=box style=max-width:100%><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img><img itemprop=thumbnail src=/img/pitot-darcy-prandtl-speed-error-fct-direction.png alt="Blue dots are speed difference between GPS and pitot. The continuous black line is the wind sine wave (phase is wind direction; 2.56m/s amplitude is wind strength) which best match the air speed and ground speed differences. Pitot values are averaged and under-sample by a factor 5."></div><a href=/img/pitot-darcy-prandtl-speed-error-fct-direction.png itemprop=contentUrl></a><figcaption><h4>GPS ground speed and pitot air speed difference in function of the plane direction during the 450s flight of a Firstar 1600.</h4><p>Blue dots are speed difference between GPS and pitot. The continuous black line is the wind sine wave (phase is wind direction; 2.56m/s amplitude is wind strength) which best match the air speed and ground speed differences. Pitot values are averaged and under-sample by a factor 5.</p></figcaption></figure></div><h4 id=script>Script</h4><p>Matlab script used for off-line wind estimation:</p><pre><code class=language-matlab>% V_gps and V_pitot are the vector with all data measured.
V_err = V_gps - V_pitot;    % Ground and Air speed difference (i.e. wind) 

M = [sin(COG); cos(COG) ]'; % COG is the direction (Theta in rad) vector data measured from the GPS
y = -V_err';
x = M\y;    % estimate wind strength and direction with linear algebra (MMSE)

Theta_Wind = atan2(x(1),x(2));  % Wind angle (rad)
V_Wind = sqrt(sum(x(1:2).^2));  % Wind strength (m/s)
</code></pre><h4 id=limitation>Limitation</h4><p>Using the GPS COG<sup class=footnote-ref id=fnref:COG><a href=#fn:COG>1</a></sup> field is not the plane yaw direction but the plane forward direction. Thus the COG is a biased plane yaw direction. It would be best to use plane orientation from the IMU sensor. It is not done here to reduce the number of sensors for this demonstration. The COG bias is small enough if we assume the wind speed to be small compared to the airplane air speed. It might be possible with a more sophisticated script to compensate this bias.</p><h4 id=other-flight-inputs>Other flight inputs</h4><p>Plane was equipped with two GPS chip:</p><ul><li>one uBlox M8N GPS and</li><li>one MTK3339.<br></li></ul><p>The uBlox trace presented on the map below is better than the MTK trace. The uBlox chip was used for the curves above. The MTK trace can be shown on the map by opening the <a href="https://www.google.com/maps/d/u/0/embed?mid=1-K7dsmfbMCDL3IQK1z3IEtSduB2OWXr9">google map link</a>. KML file can be opened with Google Earth to get a 3D view of the trace.</p><iframe src="https://www.google.com/maps/d/u/0/embed?mid=1-K7dsmfbMCDL3IQK1z3IEtSduB2OWXr9" width=640 height=480></iframe><div class=footnotes><hr><ol><li id=fn:COG>Course Over Ground
<a class=footnote-return href=#fnref:COG><sup>^</sup></a></li></ol></div></div><div class=article-tags><a class="badge badge-light" href=/tags/pitot/>Pitot</a>
<a class="badge badge-light" href=/tags/sensor/>sensor</a>
<a class="badge badge-light" href=/tags/air-speed/>air-speed</a></div><div class="media author-card" itemscope itemtype=http://schema.org/Person><img class="portrait mr-3" src=/authors/lubin/avatar_hub88d8bfcd9aca835933e1808b55368c2_25702_250x250_fill_q90_lanczos_center.jpg itemprop=image alt=Avatar><div class=media-body><h5 class=card-title itemprop=name><a href=https://lubin.kerhuel.eu/>Lubin Kerhuel</a></h5><p class=card-text itemprop=description>Interested in signal processing and control theory. 10 years experience with rapid control prototyping.</p><ul class=network-icon aria-hidden=true><li><a itemprop=sameAs href=/#contact><i class="fas fa-envelope"></i></a></li><li><a itemprop=sameAs href=https://www.linkedin.com/in/kerhuel/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a itemprop=sameAs href="https://scholar.google.co.uk/citations?user=61SJU_sAAAAJ" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li></ul></div></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/post/matek-pdb-xpw/ rel=prev>MATEKSYS PDB-XPW Dual BEC &amp; Current Module tweak to increase current measurement sensitivity</a></div></div></div></div></article><script src=/js/mathjax-config.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin=anonymous async></script><script>hljs.initHighlightingOnLoad();</script><script>const search_index_filename="/index.json";const i18n={'placeholder':"Search...",'results':"results found",'no_results':"No results found"};const content_type={'post':"Posts",'project':"Projects",'publication':"Publications",'talk':"Talks"};</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.c6046177d5eac65f434314c9d291ab15.js></script><div class=container><footer class=site-footer><p class=powered-by>&copy; 2019 Lubin Kerhuel &middot;
Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# id=back_to_top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&times;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>